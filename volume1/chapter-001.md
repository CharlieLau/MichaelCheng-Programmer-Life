# 第一章　平凡的程序员生活

程鹏飞盯着屏幕上密密麻麻的代码，揉了揉有些发酸的眼睛。已经是下午四点了，而他从早上九点就开始调试这个订单系统的并发bug，到现在依然毫无头绪。

"又是这个坑爹的数据竞争问题。"他小声嘟囔着，敲了敲键盘，重新检查了一遍synchronized块的逻辑。明明看起来没问题，但高并发的时候就偶尔会出现订单重复创建。

这是美食达人科技有限公司订餐平台的核心功能，容不得半点马虎。作为后端开发组的老员工，程鹏飞对这套系统的每一行代码都了如指掌——毕竟，其中至少有三分之一是他亲手写的。

"小程，怎么样，那个bug搞定了吗？"

程鹏飞抬起头，看到同事老张探过脑袋问道。张志远是团队里的资深工程师，四十岁出头，技术扎实，人也不错。

"还在查。"程鹏飞摇摇头，"应该是高并发的时候，Redis锁和数据库事务之间的时序问题，但具体啥时候触发还没找到。"

"啧，这种问题最烦人了。"老张同情地拍了拍他的肩膀，"要不我帮你看看？"

"不用了，张哥，你还有自己的活儿呢。"程鹏飞摆摆手，"我再想想，肯定能找到问题所在。"

老张点点头，正要回到自己座位，就听到身后传来一个有些尖锐的声音：

"程鹏飞，你过来一下。"

程鹏飞的肩膀明显僵硬了一下。这是他的直属领导赵志强的声音，语气里带着明显的不耐烦。

"来了，赵总监。"

程鹏飞起身走向会议室，路过测试组的时候，看到林小雅正在专心致志地写测试用例。她今年26岁，是公司少有的女性后端开发，技术能力很强，特别是在数据库优化方面有着独到的见解。程鹏飞偷偷看了她一眼，发现她正皱着眉头思考问题，侧脸在屏幕的蓝光映照下显得格外认真。

"发什么呆呢？"

赵志强的声音把程鹏飞拉回现实。他赶紧加快脚步走进会议室。

赵志强今年35岁，是技术部的总监，程鹏飞的顶头上司。他穿着一身笔挺的黑色西装，头发梳得一丝不苟，看起来更像是个销售经理而不是技术管理者。

"坐吧。"赵志强指了指对面的椅子，但自己依然站着，居高临下地看着程鹏飞，"订单系统的bug到现在还没解决？"

"正在调试，初步定位是并发锁的问题——"

"我不想听你的技术分析。"赵志强打断了他的话，"我只想知道什么时候能修好。产品那边天天催，说影响用户体验。"

程鹏飞心里涌起一阵无名火。这个bug的复杂程度赵志强根本不懂，他只会站在那里指手画脚。

"按现在这个进度，应该今天下班前能找到根因。"程鹏飞尽量保持平静的语气。

"应该？"赵志强的声音提高了八度，"程鹏飞，你在这公司干了六年了吧？六年！还停留在'应该'的层面？"

程鹏飞的拳头不自觉地握紧了。六年，确实是六年。从刚毕业的青涩新人，到现在29岁的资深开发，他把最美好的青春年华都献给了这家公司。可是六年来，他依然是个普通的开发工程师，而比他晚来两年的李文博已经当上了前端组的组长。

"我知道这个bug很复杂，但是——"

"复杂？"赵志强冷笑一声，"如果你技术真的过硬，什么bug不能搞定？我看是你最近工作态度有问题。整天就知道闷头写代码，一点大局观都没有。"

程鹏飞深吸一口气。他很想反驳，很想告诉赵志强，正是因为他这些年来的努力工作，公司的核心系统才能稳定运行到现在。他解决过无数个紧急bug，优化过无数个性能瓶颈，但这些成果从来没有得到过应有的认可。

"我会尽快解决的。"程鹏飞最终选择了妥协。

"尽快可不行。"赵志强走到白板前，拿起马克笔写下几个大字："今天晚上八点前，必须解决。如果解决不了，你周末就别休息了，加班到搞定为止。"

程鹏飞看着白板上的字，心中涌起深深的无力感。这就是他的职场生活——永远在被人指责，永远在加班，永远得不到应有的尊重。

"还有，"赵志强放下笔，转身看着程鹏飞，"下次遇到这种问题，要及早汇报。不要等到产品催了才说，这是工作态度问题。"

"好的。"

"行了，你回去吧。记住，八点前。"

走出会议室的时候，程鹏飞感觉全身的力气都被抽空了。他机械地走回自己的座位，重新盯着屏幕上的代码。

"怎么样？"老张小声问道。

"八点前必须搞定。"程鹏飞苦笑了一下。

"这个赵志强，"老张摇摇头，"技术不咋地，官威倒是不小。"

程鹏飞没有接话。在这个开放式的办公环境里，墙有耳朵。

他重新投入到代码调试中，这次更加专注。不是因为赵志强的威胁，而是因为他对技术的热爱和责任感。这个系统服务着成千上万的用户，每一个bug都可能影响到真实的商业交易。

下午五点半，程鹏飞突然眼前一亮。他发现在订单创建的流程中，有一个地方的锁粒度设计得不够精细。当两个用户同时下单同一家餐厅的餐品时，系统会先检查库存，再扣减库存，最后创建订单。问题就出在检查和扣减之间的那个时间窗口——如果并发请求在那个精确的时刻到达，就会绕过锁机制。

"找到了！"程鹏飞兴奋地小声说道。

他迅速修改了代码，把锁的范围扩大到整个事务过程，并且加了二次校验机制。然后在本地环境搭了个并发测试场景，模拟高峰期的订单压力。

十分钟后，测试结果出来了：bug彻底修复，系统表现完美。

"老张，你看看这个修复方案。"程鹏飞招呼老张过来。

老张仔细看了看代码，点点头："思路很清晰，双重锁机制确实能解决这个时序问题。而且性能损耗也不大，很优雅的解决方案。"

"小程厉害啊！"坐在旁边的测试工程师小美也凑过来看，"这个bug我们测试组也头疼了好久，没想到你这么快就给搞定了。"

程鹏飞心里涌起一阵暖流。这就是他喜欢这份工作的原因——不是因为公司的管理，而是因为这些志同道合的同事，因为解决技术难题时的成就感。

"程鹏飞，修好了吗？"

一个声音从身后传来。程鹏飞回头一看，是产品经理王云飞。

"刚修好，正在做最后的测试验证。"

"太好了！"王云飞一脸如释重负的表情，"这个bug真的影响很大，好几个大客户都投诉了。你这次真是救了大家的命啊！"

程鹏飞摆摆手："应该的，本来就是咱们的活儿。"

"什么应该的，技术能力强就是强。"王云飞竖起大拇指，"我马上去跟老板汇报，这次你得记一功。"

下午六点，程鹏飞把修复后的代码推到测试环境，通知相关同事验证一下。测试结果很快出来了：完美修复，没引入新问题。

"小程，这次干得漂亮！"老张拍了拍他的肩膀，"我干了这么多年，像你这样能快速定位并发问题的年轻人真不多见。"

程鹏飞正要谦虚几句，突然听到林小雅的声音：

"程鹏飞，你过来一下。"

程鹏飞心跳莫名地加快了一拍。林小雅很少主动找他说话，平时在公司里最多就是工作上的简单交流。

"怎么了？"他走到林小雅的座位旁边。

"你刚才修的那个订单系统bug，我这边在做相关的测试用例时发现了一个问题。"林小雅指着自己的屏幕，"你看这里，在极端高并发情况下，MySQL的行锁可能会升级为表锁，这样会影响整个订单表的并发性能。"

程鹏飞仔细看了看她的分析，不禁佩服起来。林小雅不愧是数据库方面的专家，居然能想到这种边界情况。

"你说得对，确实有这个风险。"程鹏飞点点头，"不过以咱们目前的业务量，短时间内应该不会触发表锁升级。但确实得考虑更优雅的解决方案。"

"我这里有个想法，"林小雅转过身看着他，眼睛里闪着专业的光芒，"可以考虑使用分布式锁，配合数据库的乐观锁机制。这样既能保证并发安全，又能避免锁升级的问题。"

程鹏飞眼前一亮。这个想法确实很棒，比他目前的方案更加健壮。

"这个思路很好，不过实现起来可能需要点时间。要不咱们明天详细讨论一下具体的技术方案？"

"好啊。"林小雅笑了笑，这是程鹏飞第一次看到她对自己笑，心跳又不争气地加快了。

正在这时，赵志强从会议室里走了出来，看到程鹏飞和林小雅在讨论技术问题，脸色微微有些不悦。

"程鹏飞，bug修好了？"

"修好了，已经通过测试验证。"程鹏飞连忙回答。

赵志强走过来看了看屏幕上的代码，虽然他其实看不太懂这些具体的技术实现，但还是摆出一副专业的样子。

"嗯，这次修复速度还算不错。"他的语气里听不出什么表扬的意思，"不过下次要提前预估风险，别等到出问题了才临时抱佛脚。"

程鹏飞心里翻了个白眼。明明是他主动发现并解决了问题，到了赵志强嘴里反而成了"临时抱佛脚"。

"知道了。"他还是选择了忍耐。

"行了，今天就这样。不过这个系统还得进一步优化，你回去想想有没有更好的方案。"赵志强说完就走了。

等赵志强走远了，林小雅才小声说道："其实你的技术能力大家都看在眼里。刚才那个修复方案真的很棒，我觉得比我们之前用的那些第三方解决方案都要优雅。"

程鹏飞心里暖洋洋的。被技术能力同样出色的同事认可，这种感觉比任何奖金都要珍贵。

"谢谢，你的建议也很中肯。确实，咱们应该考虑更长远的架构演进。"

下午七点，办公室里的人已经走得差不多了。程鹏飞整理好桌面，准备下班。明天是他的29岁生日，虽然没什么特别的安排，但至少可以早点回家休息。

"小程，一起吃个饭？"老张收拾东西的时候问道。

"不了，张哥，今天有点累。"程鹏飞摆摆手。

"行，那你早点休息。明天不是你生日吗？要不要聚一下？"

程鹏飞愣了一下。老张居然还记得他的生日，心里不禁涌起一阵感动。

"到时候再说吧，看情况。"

走出公司大楼的时候，程鹏飞回头看了看。这栋二十层的写字楼里，装着他六年来的青春和梦想。虽然现实有些骨感，但他相信，凭借自己的技术能力，总有一天会得到应有的认可。

也许，改变就从明天开始。

他不知道的是，真正的改变，确实将从明天开始——以一种他完全没有预料到的方式。

程鹏飞发动了停在地下车库的摩托车，这是一辆雅马哈R6，虽然已经买了三年，但保养得很好。在拥堵的城市里，摩托车是他最好的伙伴，也是他为数不多的兴趣爱好之一。

夜风从头盔的缝隙里钻进来，带走了一天的疲惫。明天，就是他的29岁生日了。也许该给自己一点特别的安排，比如来一次久违的夜间骑行。

他还不知道，这个看似平凡的决定，将彻底改写他的人生轨迹。